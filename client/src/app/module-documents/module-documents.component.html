<div class="container mt-4">

    <!-- Back Arrow & crumb -->
    <div class="mb-3 d-flex align-items-center">
        <button class="btn back-button d-flex align-items-center justify-content-center me-2" type="button"
            aria-label="Back to Modules" (click)="goBack()">
            <i class="bi bi-arrow-left back-icon" aria-hidden="true"></i>
        </button>
        <span class="fw-semibold back-crumb" style="cursor: pointer;" (click)="goBack()">Back to Modules</span>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-3 module-docs-header">
        <h2 class="mb-0">
            Module documents
            <ng-container *ngIf="moduleCode || moduleName">
                for {{ moduleCode ? (moduleCode | uppercase) : moduleName }}
            </ng-container>
        </h2>

        <button *ngIf="hasUploadRights()" class="btn btn-primary" (click)="openUploadModal()">
            Upload Document
        </button>
    </div>

    <table class="table table-bordered table-hover align-middle">
        <thead class="table-light">
            <tr>
                <th>Title</th>
                <th>Uploaded By</th>
                <th>Date</th>
                <th class="text-center">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let doc of documents">
                <td>{{ doc.title }}</td>
                <td>{{ doc.uploadedBy }}</td>
                <td>{{ doc.uploadedAt | date: 'medium' }}</td>
                <td class="text-center">
                    <a [href]="doc.filePath" target="_blank" rel="noopener noreferrer" download
                        class="btn btn-sm btn-success me-2">Download</a>

                    <!-- Delete shown only to original uploader -->
                    <button *ngIf="canDelete(doc)" class="btn btn-sm btn-danger"
                        (click)="confirmDelete(doc.id)">Delete</button>
                </td>
            </tr>
            <tr *ngIf="documents.length === 0">
                <td colspan="4" class="text-center text-muted">No documents found.</td>
            </tr>
        </tbody>
    </table>

    <nav *ngIf="pagination.totalPages > 1" class="d-flex justify-content-center mt-3">
        <ul class="pagination">
            <li class="page-item" [class.disabled]="pagination.currentPage === 1">
                <a class="page-link" (click)="pageChanged({ page: pagination.currentPage - 1 })">Previous</a>
            </li>
            <li class="page-item" *ngFor="let page of [].constructor(pagination.totalPages); let i = index"
                [class.active]="pagination.currentPage === i + 1">
                <a class="page-link" (click)="pageChanged({ page: i + 1 })">{{ i + 1 }}</a>
            </li>
            <li class="page-item" [class.disabled]="pagination.currentPage === pagination.totalPages">
                <a class="page-link" (click)="pageChanged({ page: pagination.currentPage + 1 })">Next</a>
            </li>
        </ul>
    </nav>
</div>