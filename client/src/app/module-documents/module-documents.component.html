<div class="container mt-4">

    <!-- Back Arrow & crumb -->
    <div class="mb-3 d-flex align-items-center">
        <button class="btn back-button d-flex align-items-center justify-content-center me-2" type="button"
            aria-label="Back to Modules" (click)="goBack()">
            <i class="bi bi-arrow-left back-icon" aria-hidden="true"></i>
        </button>
        <span class="fw-semibold back-crumb" style="cursor: pointer;" (click)="goBack()">Back to Modules</span>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-3 module-docs-header">
        <h2 class="mb-0">
            Module documents
            <ng-container *ngIf="moduleCode || moduleName">
                for {{ moduleCode ? (moduleCode | uppercase) : moduleName }}
            </ng-container>
        </h2>

        <button *ngIf="hasUploadRights()" class="btn btn-primary" (click)="openUploadModal()">
            Upload Document
        </button>
    </div>

    <!-- Cards -->
    <div class="doc-card-grid">
        <div class="card doc-card shadow-sm" *ngFor="let doc of documents">
            <!-- Kebab (uploader only) -->
            <div class="kebab" dropdown *ngIf="canDelete(doc)">
                <button class="btn btn-sm btn-outline-secondary kebab-btn" dropdownToggle type="button"
                    title="More actions">
                    <i class="bi bi-three-dots-vertical"></i>
                </button>
                <ul *dropdownMenu class="dropdown-menu dropdown-menu-end">
                    <li>
                        <button class="dropdown-item" (click)="confirmDelete(doc.id)">Delete</button>
                    </li>
                </ul>
            </div>

            <div class="card-body">
                <!-- Meta moved to TOP CENTER â€” now neon green + no seconds -->
                <div class="meta-row neon-meta d-flex justify-content-center align-items-center mb-2">
                    <small>Uploaded by: {{ doc.uploadedBy }}</small>
                    <span class="mx-2">|</span>
                    <small>
                        {{ doc.uploadedAt | date: 'mediumDate' }}, {{ doc.uploadedAt | date: 'h:mm a' }}
                    </small>
                </div>

                <div class="top-row d-flex align-items-center">
                    <img [src]="getIconPath(doc)" alt="file type" class="doc-logo" />
                    <div class="doc-title flex-grow-1" [title]="doc.title">{{ doc.title }}</div>

                    <!-- Download icon -->
                    <a [href]="doc.filePath" target="_blank" rel="noopener noreferrer" download class="download-icon"
                        aria-label="Download document" title="Download">
                        <i class="bi bi-download"></i>
                    </a>
                </div>
            </div>
        </div>

        <div *ngIf="documents.length === 0" class="text-center text-muted py-5">
            No documents found.
        </div>
    </div>

    <!-- Pagination -->
    <nav *ngIf="pagination.totalPages > 1" class="d-flex justify-content-center mt-3">
        <ul class="pagination">
            <li class="page-item" [class.disabled]="pagination.currentPage === 1">
                <a class="page-link" (click)="pageChanged({ page: pagination.currentPage - 1 })">Previous</a>
            </li>
            <li class="page-item" *ngFor="let page of [].constructor(pagination.totalPages); let i = index"
                [class.active]="pagination.currentPage === i + 1">
                <a class="page-link" (click)="pageChanged({ page: i + 1 })">{{ i + 1 }}</a>
            </li>
            <li class="page-item" [class.disabled]="pagination.currentPage === pagination.totalPages">
                <a class="page-link" (click)="pageChanged({ page: pagination.currentPage + 1 })">Next</a>
            </li>
        </ul>
    </nav>
</div>